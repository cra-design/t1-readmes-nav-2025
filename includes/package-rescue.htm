<section id="rescue-en">
  <!-- 1) Seed (default when no query param is present) -->
  <script type="application/json" id="pkg-seed">
    { "year": "2024", "href": "general-income-tax-benefit-package.html" }
  </script>

  <!-- 2) Publish dataset and wait BEFORE anything reads it -->
  <div id="pkg-json" class="wb-inv"
       data-wb-jsonmanager='{
         "url": "#pkg-seed",
         "name": "pkg",
         "wait": true,
         "debug": false
       }'></div>

  <!-- 3) URL-mapping for pkgyr (year) -->
  <div data-wb-urlmapping='{
    "pkgyr": {
      "action": "patch",
      "source": "#pkg-json",
      "match": "^(?:2016|2017|2018|2019|2020|2021|2022|2023|2024)$",
      "default": "2024",
      "patches": [
        { "op": "replace", "path": "/year", "value": "{qval}" },
        { "op": "replace", "path": "/href", "value": "archived-general-income-tax-benefit-package-{qval}.html" }
      ]
    }
  }'></div>

  <!-- 4) Sentence (base text with both generic and Manitoba versions) -->
  <p id="dnmc-rsc" class="wb-inv">
    To find other <span data-json-replace="#[pkg]/year"></span> forms or guides you may need
    <span id="for-prov-mb" class="wb-inv"> for Manitoba</span>,
    return to the
    <!-- Generic year-level link -->
    <a id="pkg-link-generic"
       data-wb-json='{"url":"#[pkg]/href","type":"attr","attr":"href"}'>
       <span data-json-replace="#[pkg]/year"></span> Income tax package
    </a>
    <!-- Manitoba-specific link (hidden until prov=mb) -->
    <a id="pkg-link-mb" class="wb-inv"
       data-wb-json='{"url":"#[pkg_mb]/href","type":"attr","attr":"href"}'>
       <span data-json-replace="#[pkg]/year"></span> Income tax package for Manitoba
    </a>.
  </p>

  <!-- 5) Show the sentence when pkgyr is present -->
  <div data-wb-urlmapping='{
    "multiplequery": true,
    "pkgyr": {
      "action": "removeClass",
      "source": "#dnmc-rsc",
      "class": "wb-inv"
    }
  }'></div>

  <!-- 6) Manitoba dataset seed -->
  <script type="application/json" id="pkg-mb-seed">
    { "href": "general-income-tax-benefit-package/manitoba.html" }
  </script>
  <div id="pkg-mb-json" class="wb-inv"
       data-wb-jsonmanager='{
         "url": "#pkg-mb-seed",
         "name": "pkg_mb",
         "wait": true
       }'></div>

  <!-- 7) Build Manitoba href from pkgyr -->
  <div data-wb-urlmapping='{
    "pkgyr": {
      "action": "patch",
      "source": "#pkg-mb-json",
      "match": "^(?:2016|2017|2018|2019|2020|2021|2022|2023|2024)$",
      "default": "2024",
      "patches": [
        { "op": "replace", "path": "/href", "value": "archived-general-income-tax-benefit-package-{qval}/manitoba.html" }
      ]
    }
  }'></div>

  <!-- 8) Reveal the Manitoba bits when prov=mb -->
  <div data-wb-urlmapping='{
    "multiplequery": true,
    "prov": [
      {
        "match": "^mb$",
        "action": "removeClass",
        "source": "#for-prov-mb",
        "class": "wb-inv"
      },
      {
        "match": "^mb$",
        "action": "removeClass",
        "source": "#pkg-link-mb",
        "class": "wb-inv"
      }
    ]
  }'></div>

  <!-- 9) Optionally hide the generic link when prov=mb -->
  <div data-wb-urlmapping='{
    "multiplequery": true,
    "prov": {
      "match": "^mb$",
      "action": "addClass",
      "source": "#pkg-link-generic",
      "class": "wb-inv"
    }
  }'></div>
</section>
<section id="rescue-fr">
</section>